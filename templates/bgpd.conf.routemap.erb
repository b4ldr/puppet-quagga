<%- if @communities.any? then
  @no_export = @communities.delete('no-export')
end 
if @localpref -%>
route-map inbound-<%= @name %> permit 10
  set local-preference <%= @localpref %>
!
<%- end -%>
<%- if @no_export -%>
route-map outbound-<%= @name %> permit 10
  match ip address prefix-list specific-v4
  set community <%= @communities.join(' ') %> <%- if @no_export -%> no-export<%- end %>
  <%- if @prepend -%>
  set as-path prepend<%= " #{@my_asn}" * @prepend.to_i %>
  <%- end -%>
<%- end -%>
<%- if @prepend or @communities.any? then -%>
route-map outbound-<%= @name %> permit 20
<%- end -%>
<%- if @prepend -%>
  set as-path prepend<%= " #{@my_asn}" * @prepend.to_i %>
<%- end -%>
<%- if @communities -%>
  set community <%= @communities.join(' ') %>
<%- end -%>
!
<%- if @no_export -%>
route-map outbound-<%= @name %>-v6 permit 10
  match ip address prefix-list specific-v6
  set community <%= @communities.join(' ') %> <%- if @no_export -%> no-export<%- end %>
  <%- if @prepend -%>
  set as-path prepend<%= " #{@my_asn}" * @prepend.to_i %>
  <%- end -%>
<%- end -%>
<%- if @prepend or @communities.any? then -%>
route-map outbound-<%= @name %>-v6 permit 20
<%- end -%>
<%- if @prepend -%>
  set as-path prepend<%= " #{@my_asn}" * @prepend.to_i %>
<%- end -%>
<%- if @communities -%>
  set community <%= @communities.join(' ') %>
<%- end -%>
!
